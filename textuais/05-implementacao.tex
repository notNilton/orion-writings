\mychapter{Implementação}
\label{Cap:Implementacao}

Este capítulo apresenta a implementação da solução desenvolvida no RADARE. O sistema foi implementado utilizando uma arquitetura modular, separando a interface gráfica, a API e os módulos de processamento de dados. Cada componente é descrito com detalhes, incluindo diagramas de blocos e o funcionamento dos principais algoritmos envolvidos.

\section{Arquitetura do Sistema}
\label{Sec:ArquiteturaSistema}

A arquitetura do RADARE foi projetada para ser flexível, escalável e eficiente. O sistema é composto por três camadas principais: a interface gráfica, o servidor web (API), e o módulo de processamento de dados. A Figura \ref{Fig:Arquitetura} ilustra essa arquitetura em nível de blocos.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.9\textwidth]{figuras/arquitetura_radare.png}
    \caption{Arquitetura do Sistema RADARE.}
    \label{Fig:Arquitetura}
\end{figure}

\subsection{Interface Gráfica}
\label{Sec:InterfaceGrafica}

A interface gráfica foi implementada utilizando \textit{React.js}, oferecendo uma experiência interativa ao usuário. Essa camada permite que o usuário visualize os dados industriais, configure processos de reconciliação e visualize os resultados. A comunicação com o servidor é feita através de chamadas HTTP utilizando a API REST desenvolvida para o sistema.

Uma das ferramentas essenciais na implementação da interface gráfica foi a biblioteca \textit{ReactFlow}. Essa biblioteca foi customizada para permitir que o usuário crie e manipule fluxogramas representando processos industriais de forma visual. A seguir, detalha-se a personalização e integração do ReactFlow na interface.

\subsubsection{Customização do ReactFlow}

O \textit{ReactFlow} foi escolhido por sua capacidade de criar diagramas interativos, que são utilizados para representar fluxos de dados e processos industriais no RADARE. Para adaptar essa ferramenta às necessidades específicas do projeto, algumas modificações foram implementadas, permitindo o suporte a novos tipos de nós (nodes) e melhorando a usabilidade.

\textbf{Adição de novos tipos de nós}: Foi necessário criar nós personalizados para representar elementos específicos dos processos industriais, como sensores, válvulas e pontos de medição. Cada nó possui configurações específicas que incluem atributos como nome, tipo de medição, e parâmetros técnicos.

\begin{verbatim}
// Exemplo de um nó personalizado no ReactFlow
const CustomNode = ({ data }) => {
  return (
    <div style={{ padding: 10, backgroundColor: '#f9f9f9', borderRadius: 5 }}>
      <strong>{data.label}</strong>
      <p>Tipo: {data.type}</p>
      <p>Medição: {data.value}</p>
    </div>
  );
};
\end{verbatim}

Esse nó personalizado é integrado no fluxo de dados e permite que o usuário visualize e edite informações em tempo real. A seguir, o código que registra o nó personalizado no ReactFlow:

\begin{verbatim}
// Registro do nó personalizado no ReactFlow
const nodeTypes = {
  customNode: CustomNode,
};
<ReactFlow elements={elements} nodeTypes={nodeTypes} />;
\end{verbatim}

\textbf{Conectividade entre os nós}: Além de criar nós personalizados, foi implementado um sistema que permite a conexão entre diferentes nós, representando o fluxo de materiais ou informações entre diferentes pontos de um processo industrial. Essas conexões são fundamentais para a visualização de fluxos complexos de processos.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.9\textwidth]{figuras/reactflow_radare.png}
    \caption{Exemplo de Fluxograma no ReactFlow com Nós Customizados.}
    \label{Fig:ReactFlow}
\end{figure}

\textbf{Eventos e Interatividade}: O \textit{ReactFlow} também foi modificado para responder a eventos como cliques e arrastes, permitindo ao usuário ajustar os fluxos de processo conforme necessário. Por exemplo, ao clicar em um nó, o usuário pode abrir uma janela de edição para alterar parâmetros ou verificar informações de medições em tempo real.

\begin{verbatim}
// Função para abrir um modal de edição ao clicar em um nó
const onNodeClick = (event, node) => {
  setNodeData(node);
  setShowModal(true);
};
<ReactFlow onNodeClick={onNodeClick} elements={elements} />;
\end{verbatim}

Essa funcionalidade adiciona uma camada de interatividade, tornando a interface mais intuitiva e eficaz para o gerenciamento de processos industriais.

\subsection{API e Comunicação}
\label{Sec:API}

A camada intermediária é composta pela API REST, desenvolvida em \textit{Node.js}, que serve como ponto de integração entre a interface gráfica e o módulo de processamento de dados. A API gerencia todas as requisições de dados e cálculos. Sua principal função é receber as configurações do usuário, processar os dados e devolver os resultados reconciliados.

A API também inclui mecanismos de segurança como autenticação via \textit{JWT} (JSON Web Tokens) e suporte a comunicação criptografada utilizando HTTPS.

\subsection{Módulo de Processamento de Dados}
\label{Sec:ModuloProcessamento}

O módulo de processamento é o núcleo da aplicação, onde os cálculos de reconciliação de dados são realizados. Esse módulo foi desenvolvido em \textit{Python}, utilizando bibliotecas científicas como \textit{NumPy} e \textit{SciPy} para cálculos de otimização e álgebra linear. O método de minimização utilizado segue o formalismo descrito no Capítulo \ref{Cap:Metodologia}, baseado nos multiplicadores de Lagrange.

\section{Modelagem de Dados}
\label{Sec:ModelagemDados}

A modelagem de dados foi realizada utilizando um banco de dados relacional PostgreSQL, que armazena as informações dos processos industriais, os dados de medições e os resultados das reconciliações. O modelo entidade-relacionamento é mostrado na Figura \ref{Fig:ERModel}, que descreve as relações entre as tabelas principais.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\textwidth]{figuras/er_model.png}
    \caption{Modelo entidade-relacionamento do sistema RADARE.}
    \label{Fig:ERModel}
\end{figure}

As principais entidades incluem:

\begin{itemize}
    \item \textbf{Processos}: Tabela que armazena os dados dos processos industriais, incluindo as variáveis medidas e os parâmetros de entrada.
    \item \textbf{Medições}: Armazena os dados de medição recebidos das plantas industriais.
    \item \textbf{Resultados}: Contém os resultados das reconciliações, vinculados ao processo correspondente.
\end{itemize}

\section{Algoritmos Implementados}
\label{Sec:AlgoritmosImplementados}

Os principais algoritmos implementados no RADARE estão relacionados à reconciliação de dados e à integração numérica. Um dos algoritmos centrais é o cálculo da reconciliação via minimização de funções multivariáveis utilizando o método dos multiplicadores de Lagrange.

\subsection{Reconciliação de Dados}
\label{Sec:ReconciliaçãoDados}

O algoritmo de reconciliação de dados, descrito no Capítulo \ref{Cap:Metodologia}, foi implementado em Python. A fórmula utilizada é baseada na minimização das diferenças entre as medições reais e os valores reconciliados, respeitando as restrições impostas pelas equações de balanço de massa e energia. O Algoritmo \ref{algo:Reconciliação} descreve o processo de cálculo da reconciliação.

\begin{algorithm}
\Entrada{$y$: valores de medições; $A$: matriz de coeficientes; $b$: vetor de restrições }
\Saida{$x$: valores reconciliados}
Inicializar $\lambda \leftarrow 0$ (multiplicadores de Lagrange)\;
Resolver $\min_x \left( \sum (y - x)^2 \right)$ sujeito a $Ax = b$\;
\Retorna $x$\;
\caption{Algoritmo de Reconciliação de Dados utilizando Multiplicadores de Lagrange.}
\label{algo:Reconciliação}
\end{algorithm}

\section{Considerações sobre a Implementação}
\label{Sec:ConsideracoesImplementacao}

A implementação do RADARE foi conduzida com foco na modularidade e escalabilidade do sistema. A escolha de \textit{React.js} para a interface, \textit{Node.js} para a API e \textit{Python} para o processamento garantiu uma integração eficiente entre as diferentes camadas do sistema.

Em relação à segurança e performance, a utilização de \textit{JWT} para autenticação e a comunicação segura via HTTPS garantem que os dados industriais sejam tratados com a devida proteção, enquanto que a implementação otimizada dos algoritmos permitiu a execução em tempo real, mesmo para grandes volumes de dados.
